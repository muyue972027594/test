/***第四题：解析算式***/
#include<stdio.h>
#include<string.h>
int main()
{
	char c1[50],c2[9];
	int i,j=0,k=0,n,f=1,a1=0,a2=0;
	float a[10]={0};
	printf("请输入一个算式\n");
	fgets(c1,50,stdin);
	for(i=0;i<strlen(c1);i++)
	{
		if(c1[i]>='0'&&c1[i]<='9')
		{
			f=1;
			a[j]+=c1[i]-48;
			a[j]*=10;
			continue;
		}
		else
		{ 
			if(f==1)
			{
				a[j]/=10;j++;f=0;
			}
			if(c1[i]=='+'||c1[i]=='-'||c1[i]=='*'||c1[i]=='/')
			{
				c2[k]=c1[i];
				k++;
			}
			c2[k]='\0';
		}
	}	
//	for(i=0;i<j;i++)
//		printf("%g ",a[i]);
//	printf("\n%s\n",c2);
	for(i=0;a2<k;i++)
	{	
		if(a1<=k)
		{
			a1++;
			if(c2[i]=='*')
			{
				a[i]*=a[i+1];
					c2[i]='\0';
				for(n=i;n<k-1;n++)
				{
					a[n+1]=a[n+2];
					c2[n]=c2[n+1];
				}
				k-=1;i-=1;a1-=1;
			}
			if(c2[i]=='/')
			{
				a[i]/=a[i+1];
					c2[i]='\0';
				for(n=i;n<k-1;n++)
				{
					a[n+1]=a[n+2];
					c2[n]=c2[n+1];
				}
				k-=1;i-=1;a1-=1;
			}
		}
		if(a1==k+1) i=0;
		if(a1>k&&a2<=k)
		{
			a2++;a1++;
			if(c2[i]=='+')
			{
				a[i]+=a[i+1];
					c2[i]='\0';
				for(n=i;n<k-1;n++)
				{
					a[n+1]=a[n+2];
					c2[n]=c2[n+1];
				}
				k-=1;i-=1;a2-=1;
			}
			if(c2[i]=='-')
			{
				a[i]-=a[i+1];
					c2[i]='\0';
				for(n=i;n<k-1;n++)
				{
					a[n+1]=a[n+2];
					c2[n]=c2[n+1];
				}
				k-=1;i-=1;a2-=1;
			}	
		}
	}
	printf("\n计算结果为%g\n",a[0]);
}
